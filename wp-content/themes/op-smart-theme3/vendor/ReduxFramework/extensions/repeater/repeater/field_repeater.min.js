!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.repeater=redux.field_objects.repeater||{},e(document).ready(function(){}),redux.field_objects.repeater.sort_repeaters=function(r){r.hasClass("redux-container-repeater")||(r=r.parents(".redux-container-repeater:first")),r.find(".redux-repeater-accordion-repeater").each(function(r){var t=e(this).attr("data-sortid");e(this).find("input[name*='["+t+"]']").each(function(){e(this).attr("name",e(this).attr("name").replace("["+t+"]","["+r+"]"))}),e(this).find("select[name*='["+t+"]']").each(function(){e(this).attr("name",e(this).attr("name").replace("["+t+"]","["+r+"]"))}),e(this).find("textarea[name*='["+t+"]']").each(function(){e(this).attr("name",e(this).attr("name").replace("["+t+"]","["+r+"]"))}),e(this).attr("data-sortid",r);var a=e(this).find(".ui-accordion-header"),i=a.attr("id").split("-header-");a.attr("id",i[0]+"-header-"+r),i=a.attr("aria-controls").split("-panel-"),a.attr("aria-controls",i[0]+"-panel-"+r);var d=e(this).find(".ui-accordion-content");i=d.attr("id").split("-panel-");d.attr("id",i[0]+"-panel-"+r),i=d.attr("aria-labelledby").split("-header-"),d.attr("aria-labelledby",i[0]+"-header-"+r)})},redux.field_objects.repeater.init=function(r){r||(r=e(document).find(".redux-group-tab:visible").find(".redux-container-repeater:visible")),e(r).each(function(r){var t=e(this),a=t;if(t.hasClass("redux-field-container")||(a=t.parents(".redux-field-container:first")),!a.is(":hidden")&&a.hasClass("redux-field-init")){a.removeClass("redux-field-init");a=t;t.hasClass("redux-field-container")||(a=t.parents(".redux-field-container:first"));var i=a.attr("data-id"),d=t.find(".redux-repeater-accordion-repeater:last-child");if(redux.repeater[i].blank=d.clone().wrap("<p>").parent().html(),a.hasClass("redux-container-repeater")&&a.addClass("redux-field-init"),a.hasClass("redux-field-init")){a.removeClass("redux-field-init");var n=t.find(".redux-repeater-accordion").accordion({header:"> div > fieldset > h3",collapsible:!0,activate:function(r,t){e.redux.initFields()},heightStyle:"content",icons:{header:"ui-icon-plus",activeHeader:"ui-icon-minus"}});1==redux.repeater[i].sortable?n.sortable({axis:"y",handle:"h3",connectWith:".redux-repeater-accordion",placeholder:"ui-state-highlight",start:function(e,r){r.placeholder.height(r.item.height()),r.placeholder.width(r.item.width())},stop:function(r,t){t.item.children("h3").triggerHandler("focusout"),redux.field_objects.repeater.sort_repeaters(e(this))}}):n.find("h3.ui-accordion-header").css("cursor","pointer"),t.find(".redux-repeater-accordion-repeater .bind_title").on("change keyup",function(r){if(e(r.target).find(":selected").text().length>0)var t=e(r.target).find(":selected").text();else t=e(r.target).val();e(this).closest(".redux-repeater-accordion-repeater").find(".redux-repeater-header").text(t)}),e(document.body).on("click",".redux-repeaters-remove",function(){redux_change(e(this));var r=e(this).parents(".redux-container-repeater:first"),a=r.attr("data-id");redux.repeater[a].blank=e(this).parents(".redux-repeater-accordion-repeater:first").clone(!0,!0),e(this).parents(".redux-repeater-accordion-repeater:first").slideUp("medium",function(){(e(this).remove(),redux.field_objects.repeater.sort_repeaters(t),""!=redux.repeater[a].limit)&&(r.find(".redux-repeater-accordion-repeater").length<redux.repeater[a].limit&&r.find(".redux-repeaters-add").removeClass("button-disabled"));r.find(".redux-repeater-accordion-repeater:last .ui-accordion-header").click()})}),String.prototype.reduxReplaceAll=function(e,r){return this.replace(new RegExp(e.replace(/[.^$*+?()[{\|]/g,"\\$&"),"g"),r)},t.find(".redux-repeaters-add").click(function(){if(!e(this).hasClass("button-disabled")){var r=e(this).parent().find(".redux-repeater-accordion:first"),a=r.find(".redux-repeater-accordion-repeater").length,i=r.attr("data-id");if(""!=redux.repeater[i].limit&&a>=redux.repeater[i].limit)e(this).addClass("button-disabled");else{a++;var d,n=r.find(".redux-repeater-accordion-repeater").size();if(r.find(".redux-repeater-accordion-repeater:last").find(".ui-accordion-header").hasClass("ui-state-active")&&r.find(".redux-repeater-accordion-repeater:last").find(".ui-accordion-header").click(),0==(d=r.find(".redux-repeater-accordion-repeater:last").clone(!0,!0)).length&&(d=redux.repeater[i].blank),redux.repeater[i]){redux.repeater[i].count=t.find(".redux-repeater-header").length;var c=redux.repeater[i].html.reduxReplaceAll("99999",n);e(d).find(".redux-repeater-header").text("")}d.find(".ui-accordion-content").html(c),e(r).append(d),redux.field_objects.repeater.sort_repeaters(d),(d=e(this).parent().find(".redux-repeater-accordion:first")).find(".redux-repeater-accordion-repeater:last .ui-accordion-header").click(),d.find(".redux-repeater-accordion-repeater:last .bind_title").on("change keyup",function(r){if(e(r.target).find(":selected").text().length>0)var t=e(r.target).find(":selected").text();else t=e(r.target).val();e(this).closest(".redux-repeater-accordion-repeater").find(".redux-repeater-header").text(t)}),redux.repeater[i].limit>0&&a>=redux.repeater[i].limit&&e(this).addClass("button-disabled")}}})}}})}}(jQuery);